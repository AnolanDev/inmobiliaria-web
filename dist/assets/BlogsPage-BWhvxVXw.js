import{d as E,c as n,o,b as Y,s as Z,r as B,i as P,w as ee,k as se,G as te,g as T,l as ae,a as e,f as v,q as l,F as p,p as h,t as c,B as V,C as oe,E as z,n as R,e as $,j as F}from"./index-BkE6U2tp.js";import{u as le,B as U}from"./BlogCard-DUUxtEyG.js";import{_ as G,A as ne}from"./AppLayout-BJ0DIrYw.js";import"./api-Cpf0xzVV.js";import"./ResponsiveImage-oMFbyBJt.js";const ie={class:"bg-white rounded-xl border border-gray-200 overflow-hidden animate-pulse"},re=E({__name:"BlogCardSkeleton",setup(H){return(k,d)=>(o(),n("div",ie,d[0]||(d[0]=[Y('<div class="h-48 sm:h-52 md:h-56 bg-gray-200" data-v-181e103e></div><div class="p-4 space-y-3" data-v-181e103e><div class="space-y-2" data-v-181e103e><div class="h-4 bg-gray-200 rounded w-3/4" data-v-181e103e></div><div class="h-4 bg-gray-200 rounded w-1/2" data-v-181e103e></div></div><div class="flex items-center space-x-3" data-v-181e103e><div class="w-4 h-4 bg-gray-200 rounded-full" data-v-181e103e></div><div class="h-3 bg-gray-200 rounded w-20" data-v-181e103e></div><div class="h-3 bg-gray-200 rounded w-16" data-v-181e103e></div></div><div class="space-y-2" data-v-181e103e><div class="h-3 bg-gray-200 rounded w-full" data-v-181e103e></div><div class="h-3 bg-gray-200 rounded w-4/5" data-v-181e103e></div></div><div class="flex space-x-2" data-v-181e103e><div class="h-6 bg-gray-200 rounded-full w-12" data-v-181e103e></div><div class="h-6 bg-gray-200 rounded-full w-16" data-v-181e103e></div><div class="h-6 bg-gray-200 rounded-full w-10" data-v-181e103e></div></div><div class="flex justify-between items-center pt-2" data-v-181e103e><div class="flex space-x-4" data-v-181e103e><div class="h-3 bg-gray-200 rounded w-12" data-v-181e103e></div><div class="h-3 bg-gray-200 rounded w-8" data-v-181e103e></div></div><div class="h-3 bg-gray-200 rounded w-16" data-v-181e103e></div></div><div class="pt-3 border-t border-gray-200" data-v-181e103e><div class="h-9 bg-gray-200 rounded w-full" data-v-181e103e></div></div></div>',2)])))}}),j=G(re,[["__scopeId","data-v-181e103e"]]),de={key:0,class:"main-content"},ue={class:"container"},ce={class:"blogs-section"},ve={class:"blogs-grid"},ge={key:1,class:"error-container"},pe={class:"error-content"},he={class:"error-message"},fe={key:2,class:"main-content"},ye={class:"container"},_e={class:"filters-section"},be={class:"filter-row"},ke={class:"search-container"},me={class:"search-input-wrapper"},we={class:"filter-container"},xe=["value"],Ce={class:"filter-container"},Be={key:0,class:"active-filters"},Pe={class:"filter-tags"},Me={key:0,class:"filter-tag"},Le={key:1,class:"filter-tag"},Se={key:0,class:"featured-section"},Te={class:"featured-grid"},Ve={class:"results-info"},$e={class:"results-text"},Fe={key:0},je={key:1},Ae={class:"blogs-section"},De={key:0,class:"no-results"},Ne={key:1,class:"blogs-grid"},Ie={key:1,class:"load-more-container"},qe=["disabled"],ze={key:0},Re={key:1,class:"flex items-center"},Ue={class:"load-more-info"},Ee={key:2,class:"pagination"},Ge=["disabled"],He={class:"pagination-numbers"},Oe=["onClick"],Qe=["disabled"],We={key:3,class:"loading-overlay"},Je=E({__name:"BlogsPage",setup(H){const k=le(),{blogs:d,featuredBlogs:f,categories:O,isLoading:y,error:A,pagination:i}=Z(k),r=B(""),u=B(""),w=B("recent"),x=B([]);let M=null;const g=P(()=>r.value.length>0||u.value.length>0),_=P(()=>{let a=g.value?x.value:d.value;if(!g.value&&f.value.length>0){const s=new Set(f.value.map(t=>t.id));a=a.filter(t=>!s.has(t.id))}return w.value==="popular"?a=[...a].sort((s,t)=>(t.views_count||0)-(s.views_count||0)):w.value==="title"?a=[...a].sort((s,t)=>s.title.localeCompare(t.title)):a=[...a].sort((s,t)=>new Date(t.published_at).getTime()-new Date(s.published_at).getTime()),a}),Q=P(()=>{const a=_.value.length;return{"blogs-grid":!0,"single-blog":a===1,"two-blogs":a===2,"three-blogs":a===3,"multiple-blogs":a>3}}),W=P(()=>{const a=i.value.currentPage,s=i.value.lastPage,t=2,m=[],b=[];for(let S=Math.max(2,a-t);S<=Math.min(s-1,a+t);S++)m.push(S);return a-t>2?b.push(1,"..."):b.push(1),b.push(...m),a+t<s-1?b.push("...",s):s>1&&b.push(s),b}),D=async(a=1)=>{await k.fetchBlogs({with:"media,image,featured_image",include:"featured_image,gallery,media,image",fields:"*"},a)},N=()=>{M&&clearTimeout(M),M=setTimeout(()=>{C()},300)},C=()=>{if(!u.value&&!r.value){x.value=[];return}let a=[...d.value];if(u.value&&(a=a.filter(s=>s.category===u.value)),r.value){const s=r.value.toLowerCase().trim();a=a.filter(t=>t.title.toLowerCase().includes(s)||t.excerpt.toLowerCase().includes(s)||t.content.toLowerCase().includes(s)||t.tags.some(m=>m.toLowerCase().includes(s))||t.category.toLowerCase().includes(s))}x.value=a},J=()=>{},I=()=>{r.value="",N()},K=()=>{u.value="",C()},q=()=>{r.value="",u.value="",x.value=[]},X=async()=>{i.value.currentPage<i.value.lastPage&&await k.loadMoreBlogs(i.value.currentPage+1)},L=a=>{a>=1&&a<=i.value.lastPage&&(D(a),window.scrollTo({top:0,behavior:"smooth"}))};return ee([r,u],()=>{C()}),se(async()=>{try{await k.initializeBlogsPage(),await te()}catch(a){console.error("Failed to load blogs:",a)}}),(a,s)=>(o(),T(ne,null,{default:ae(()=>[s[21]||(s[21]=e("section",{class:"page-header"},[e("div",{class:"container"},[e("div",{class:"header-content"},[e("h1",{class:"page-title"},"Blog"),e("p",{class:"page-description"}," Descubre artículos, consejos y tendencias del sector inmobiliario ")])])],-1)),l(y)&&l(d).length===0?(o(),n("div",de,[e("div",ue,[e("div",ce,[e("div",ve,[(o(),n(p,null,h(6,t=>F(j,{key:`skeleton-${t}`})),64))])])])])):l(A)&&l(d).length===0?(o(),n("div",ge,[e("div",pe,[s[5]||(s[5]=e("svg",{class:"error-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 15.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),e("p",he,c(l(A)),1),e("button",{onClick:D,class:"retry-btn"},"Reintentar")])])):(o(),n("div",fe,[e("div",ye,[e("div",_e,[e("div",be,[e("div",ke,[e("div",me,[s[7]||(s[7]=e("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"11",cy:"11",r:"8"}),e("path",{d:"M21 21l-4.35-4.35"})],-1)),V(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>r.value=t),type:"text",placeholder:"Buscar blogs...",class:"search-input",onInput:N},null,544),[[oe,r.value]]),r.value?(o(),n("button",{key:0,onClick:I,class:"clear-search-btn"},s[6]||(s[6]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))):v("",!0)])]),e("div",we,[V(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>u.value=t),onChange:C,class:"filter-select"},[s[8]||(s[8]=e("option",{value:""},"Todas las categorías",-1)),(o(!0),n(p,null,h(l(O),t=>(o(),n("option",{key:t,value:t},c(t),9,xe))),128))],544),[[z,u.value]])]),e("div",Ce,[V(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>w.value=t),onChange:J,class:"filter-select"},s[9]||(s[9]=[e("option",{value:"recent"},"Más recientes",-1),e("option",{value:"popular"},"Más populares",-1),e("option",{value:"title"},"Por título",-1)]),544),[[z,w.value]])])]),g.value?(o(),n("div",Be,[s[12]||(s[12]=e("span",{class:"active-filters-label"},"Filtros activos:",-1)),e("div",Pe,[r.value?(o(),n("span",Me,[e("span",null,'Búsqueda: "'+c(r.value)+'"',1),e("button",{onClick:I},s[10]||(s[10]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))])):v("",!0),u.value?(o(),n("span",Le,[e("span",null,"Categoría: "+c(u.value),1),e("button",{onClick:K},s[11]||(s[11]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))])):v("",!0)]),e("button",{onClick:q,class:"clear-filters-btn"}," Limpiar todos los filtros ")])):v("",!0)]),l(f).length>0&&!g.value?(o(),n("section",Se,[s[13]||(s[13]=e("div",{class:"section-header"},[e("h2",{class:"section-title"},"Artículos destacados")],-1)),e("div",Te,[(o(!0),n(p,null,h(l(f).slice(0,3),t=>(o(),T(U,{key:`featured-${t.id}`,blog:t,class:"featured-card"},null,8,["blog"]))),128))])])):v("",!0),e("div",Ve,[e("p",$e,[g.value?(o(),n("span",Fe,c(_.value.length)+" "+c(_.value.length===1?"resultado encontrado":"resultados encontrados"),1)):(o(),n("span",je," Mostrando "+c(_.value.length)+" blogs"+c(l(f).length>0?` (+ ${l(f).length} destacados)`:""),1))])]),e("section",Ae,[_.value.length===0&&g.value?(o(),n("div",De,[s[14]||(s[14]=e("svg",{class:"no-results-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),s[15]||(s[15]=e("h3",null,"No se encontraron blogs",-1)),s[16]||(s[16]=e("p",null,"Intenta ajustar tus filtros de búsqueda",-1)),e("button",{onClick:q,class:"clear-filters-btn"}," Ver todos los blogs ")])):v("",!0),l(y)&&l(d).length===0?(o(),n("div",Ne,[(o(),n(p,null,h(6,t=>F(j,{key:`skeleton-${t}`})),64))])):(o(),n("div",{key:2,class:R(Q.value)},[(o(!0),n(p,null,h(_.value,t=>(o(),T(U,{key:t.id,blog:t},null,8,["blog"]))),128)),l(y)&&l(d).length>0?(o(),n(p,{key:0},h(3,t=>F(j,{key:`loading-${t}`})),64)):v("",!0)],2))]),l(i).currentPage<l(i).lastPage&&!g.value?(o(),n("div",Ie,[e("button",{onClick:X,disabled:l(y),class:"load-more-btn"},[l(y)?(o(),n("span",Re,s[17]||(s[17]=[e("div",{class:"loading-spinner-small mr-2"},null,-1),$(" Cargando... ",-1)]))):(o(),n("span",ze,"Cargar más artículos"))],8,qe),e("p",Ue," Mostrando "+c(l(d).length)+" de "+c(l(i).total)+" artículos ",1)])):v("",!0),l(i).lastPage>1&&g.value?(o(),n("div",Ee,[e("button",{onClick:s[3]||(s[3]=t=>L(l(i).currentPage-1)),disabled:l(i).currentPage<=1,class:"pagination-btn"},s[18]||(s[18]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1),$(" Anterior ",-1)]),8,Ge),e("div",He,[(o(!0),n(p,null,h(W.value,t=>(o(),n("button",{key:t,onClick:m=>L(t),class:R(["pagination-number",{active:t===l(i).currentPage}])},c(t),11,Oe))),128))]),e("button",{onClick:s[4]||(s[4]=t=>L(l(i).currentPage+1)),disabled:l(i).currentPage>=l(i).lastPage,class:"pagination-btn"},s[19]||(s[19]=[$(" Siguiente ",-1),e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 18l6-6-6-6"})],-1)]),8,Qe)])):v("",!0)])])),l(y)&&l(d).length>0?(o(),n("div",We,s[20]||(s[20]=[e("div",{class:"loading-spinner"},null,-1)]))):v("",!0)]),_:1,__:[21]}))}}),ss=G(Je,[["__scopeId","data-v-84d2a32f"]]);export{ss as default};
