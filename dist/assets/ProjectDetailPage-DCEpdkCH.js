import{d as T,v as E,r as _,c as H,x as N,o as R,k as G,m as O,p as U,a,e,s as C,f as r,t as l,F as w,g as P,i as p,j as q,u as W,b as s,n as M}from"./index-BUfqj1t8.js";import{u as Z}from"./projects-CvcIJbax.js";import{A as J,_ as K}from"./AppLayout-B8qPjFyP.js";import"./api-nBsutl_a.js";const Q={key:0,class:"loading-container"},X={key:1,class:"error-container"},Y={class:"error-content"},ee={class:"error-message"},te={key:0,class:"error-details"},oe={key:2,class:"project-detail-container"},se={class:"project-hero"},ae={class:"hero-content"},ne={class:"project-image-section"},le={class:"main-image-container"},ie=["src","alt"],re={key:2,class:"image-counter"},ce={key:0,class:"thumbnails-container"},de=["onClick"],ue=["src","alt"],ve={class:"project-info-section"},pe={class:"project-header"},ge={class:"project-name"},he={class:"project-card-info"},me={key:0,class:"project-type-card"},_e={class:"project-location-card"},ke={key:0},fe={key:1},ye={key:0},xe={key:2},be={class:"project-details-grid"},je={key:0,class:"detail-item"},Ce={class:"detail-content"},we={class:"detail-value"},Pe={key:1,class:"detail-item"},Be={class:"detail-content"},Me={key:2,class:"detail-item"},Ie={class:"detail-content"},Ve={class:"detail-value"},De={key:0,class:"agent-info"},ze={class:"agent-avatar"},Ae=["src","alt"],$e={class:"agent-details-mini"},Le={class:"agent-name-mini"},Se={key:0,class:"agent-type-mini"},Fe={class:"agent-contact-mini"},Te=["href"],Ee=["href"],He={key:1,class:"stats-section"},Ne={class:"stat-item"},Re={class:"stat-number"},Ge={key:0,class:"project-description-section"},Oe={class:"description-container"},Ue={class:"section-title"},qe={class:"description-content"},We={class:"description-paragraphs"},Ze={key:1,class:"info-notice"},Je={key:2,class:"project-properties"},Ke={class:"properties-container"},Qe={class:"section-title"},Xe={class:"properties-grid"},Ye=["onClick"],et={class:"property-image-container"},tt=["src","alt"],ot={class:"property-price-badge"},st={class:"property-info"},at={class:"property-title"},nt={class:"property-address"},lt={class:"property-features"},it={key:0,class:"feature"},rt={key:1,class:"feature"},ct={key:2,class:"feature"},dt={key:3,class:"feature"},ut={key:3,class:"not-found-container"},vt=T({__name:"ProjectDetailPage",setup(pt){const I=N(),y=W(),k=Z(),{currentProject:gt,loading:ht,error:x}=E(k),o=_(null),g=_(!0),u=_(0),h=_(""),d=_([]),b=H(()=>parseInt(I.params.id)),f=n=>n||"/placeholder-project.svg",V=n=>n?new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n):"Precio no disponible",D=n=>{if(!n)return[];let t=n.split(/\.\s+(?=[A-Z])|[\n\r]{2,}/).map(c=>c.trim()).filter(c=>c.length>0);return t.length===1&&n.length>200&&(t=n.split(new RegExp("(?<=[.!?])\\s+")).reduce((c,i,v)=>{const m=Math.floor(v/2);return c[m]||(c[m]=""),c[m]+=(c[m]?" ":"")+i,c},[]).filter(c=>c.trim().length>0)),t.map(c=>c.endsWith(".")?c:c+".")},z=()=>{var n;console.log("Setting up image gallery for project:",(n=o.value)==null?void 0:n.name),o.value&&(d.value=[o.value.cover_image_url,...o.value.gallery_urls||[]].filter(Boolean),h.value=d.value[0]||o.value.cover_image_url,u.value=0,console.log("Gallery setup complete, images:",d.value.length))},A=()=>{u.value<d.value.length-1&&(u.value++,h.value=d.value[u.value])},$=()=>{u.value>0&&(u.value--,h.value=d.value[u.value])},L=n=>{u.value=n,h.value=d.value[n]},j=()=>{y.push("/proyectos")},S=n=>{y.push(`/propiedades/${n}`)},F=n=>{y.push(`/agentes/${n}`)},B=async()=>{var n;if(console.log("fetchProjectData called with projectId:",b.value),g.value=!0,b.value)try{k.projects.length===0&&(console.log("Loading projects list first..."),await k.fetchProjects());const t=k.projects.find(c=>c.id===b.value);console.log("Found existing project:",t==null?void 0:t.name),t?(o.value=t,z(),console.log("Set project from existing data")):(console.log("Project not found in list"),o.value=null)}catch(t){console.error("Error in fetchProjectData:",t),o.value=null}finally{g.value=!1,console.log("Loading finished, project:",(n=o.value)==null?void 0:n.name)}else g.value=!1};return R(()=>{console.log("ProjectDetailPage mounted"),B()}),G(o,n=>{console.log("Project changed:",n==null?void 0:n.name)},{immediate:!0}),(n,t)=>(s(),O(J,null,{default:U(()=>{var c;return[g.value?(s(),a("div",Q,t[1]||(t[1]=[e("div",{class:"loading-content"},[e("div",{class:"loading-spinner"}),e("p",{class:"loading-text"},"Cargando información del proyecto...")],-1)]))):C(x)&&!o.value?(s(),a("div",X,[e("div",Y,[t[2]||(t[2]=e("svg",{class:"error-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 15.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),e("p",ee,l(C(x)),1),(c=C(x))!=null&&c.includes("servidor")?(s(),a("p",te," El proyecto puede no estar disponible temporalmente. Por favor, inténtalo más tarde o contacta con el administrador. ")):r("",!0),e("div",{class:"error-actions"},[e("button",{onClick:B,class:"retry-btn"}," Reintentar "),e("button",{onClick:j,class:"back-btn-error"}," Volver a Proyectos ")])])])):o.value&&o.value.id?(s(),a("div",oe,[e("div",{class:"back-navigation"},[e("button",{onClick:j,class:"back-btn"},t[3]||(t[3]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),e("span",null,"Volver a Proyectos",-1)]))]),e("section",se,[e("div",ae,[e("div",ne,[e("div",le,[e("img",{src:f(h.value),alt:o.value.name,class:"project-main-image"},null,8,ie),d.value.length>1?(s(),a("button",{key:0,onClick:$,class:"image-nav-btn image-nav-prev"},t[4]||(t[4]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)]))):r("",!0),d.value.length>1?(s(),a("button",{key:1,onClick:A,class:"image-nav-btn image-nav-next"},t[5]||(t[5]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 18l6-6-6-6"})],-1)]))):r("",!0),d.value.length>1?(s(),a("div",re,l(u.value+1)+" / "+l(d.value.length),1)):r("",!0)]),d.value.length>1?(s(),a("div",ce,[(s(!0),a(w,null,P(d.value,(i,v)=>(s(),a("div",{key:v,class:M(["thumbnail-item",{active:u.value===v}]),onClick:m=>L(v)},[e("img",{src:f(i),alt:`${o.value.name} - ${v+1}`},null,8,ue)],10,de))),128))])):r("",!0)]),e("div",ve,[e("div",pe,[e("h1",ge,l(o.value.name),1),e("div",he,[o.value.type?(s(),a("div",me,l(o.value.type),1)):r("",!0),e("div",_e,[t[6]||(t[6]=e("svg",{class:"location-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),e("circle",{cx:"12",cy:"10",r:"3"})],-1)),o.value.location?(s(),a("span",ke,l(o.value.location),1)):o.value.city?(s(),a("span",fe,[p(l(o.value.city),1),o.value.state?(s(),a("span",ye,", "+l(o.value.state),1)):r("",!0)])):(s(),a("span",xe,"Ubicación por definir"))])])]),e("div",be,[o.value.type?(s(),a("div",je,[t[8]||(t[8]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),e("polyline",{points:"7.5,4.21 12,6.81 16.5,4.21"}),e("polyline",{points:"7.5,19.79 7.5,14.6 3,12"}),e("polyline",{points:"21,12 16.5,14.6 16.5,19.79"})],-1)),e("div",Ce,[t[7]||(t[7]=e("span",{class:"detail-label"},"Tipo de Proyecto",-1)),e("span",we,l(o.value.type),1)])])):r("",!0),o.value.status?(s(),a("div",Pe,[t[10]||(t[10]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"m9 12 2 2 4-4"})],-1)),e("div",Be,[t[9]||(t[9]=e("span",{class:"detail-label"},"Estado",-1)),e("span",{class:"detail-value",style:q({color:o.value.status_color||"#28a745"})},l(o.value.status),5)])])):r("",!0),o.value.videos&&o.value.videos.length>0?(s(),a("div",Me,[t[12]||(t[12]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polygon",{points:"5,3 19,12 5,21"})],-1)),e("div",Ie,[t[11]||(t[11]=e("span",{class:"detail-label"},"Videos",-1)),e("span",Ve,l(o.value.videos.length)+" "+l(o.value.videos.length===1?"Video":"Videos"),1)])])):r("",!0)]),o.value.agent?(s(),a("div",De,[t[15]||(t[15]=e("h3",null,"Agente del Proyecto",-1)),e("div",{class:"agent-card-mini",onClick:t[0]||(t[0]=i=>F(o.value.agent.id))},[e("div",ze,[e("img",{src:f(o.value.agent.profile_picture_url),alt:o.value.agent.name,class:"agent-image-mini"},null,8,Ae)]),e("div",$e,[e("h4",Le,l(o.value.agent.name),1),o.value.agent.type?(s(),a("p",Se,l(o.value.agent.type),1)):r("",!0),e("div",Fe,[o.value.agent.phone?(s(),a("a",{key:0,href:`tel:${o.value.agent.phone}`,class:"contact-mini"},[t[13]||(t[13]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})],-1)),p(" "+l(o.value.agent.phone),1)],8,Te)):r("",!0),o.value.agent.email?(s(),a("a",{key:1,href:`mailto:${o.value.agent.email}`,class:"contact-mini"},[t[14]||(t[14]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),e("polyline",{points:"22,6 12,13 2,6"})],-1)),p(" "+l(o.value.agent.email),1)],8,Ee)):r("",!0)])])])])):r("",!0),o.value.property_count?(s(),a("div",He,[e("div",Ne,[e("div",Re,l(o.value.property_count),1),t[16]||(t[16]=e("div",{class:"stat-label"},"Propiedades",-1))])])):r("",!0)])])]),o.value.description?(s(),a("section",Ge,[e("div",Oe,[e("h2",Ue,"Sobre "+l(o.value.name),1),e("div",qe,[e("div",We,[(s(!0),a(w,null,P(D(o.value.description),(i,v)=>(s(),a("p",{key:v,class:M(["description-paragraph",{"first-paragraph":v===0}])},l(i),3))),128))])])])])):o.value&&!g.value?(s(),a("section",Ze,t[17]||(t[17]=[e("div",{class:"notice-container"},[e("div",{class:"notice-content"},[e("svg",{class:"notice-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("p",{class:"notice-text"}," Mostrando información básica del proyecto. Para ver detalles completos, contacta con nuestro equipo. ")])],-1)]))):r("",!0),o.value.properties&&o.value.properties.length>0?(s(),a("section",Je,[e("div",Ke,[e("h2",Qe,"Propiedades del Proyecto ("+l(o.value.properties.length)+")",1),e("div",Xe,[(s(!0),a(w,null,P(o.value.properties,i=>(s(),a("div",{key:i.id,class:"property-card",onClick:v=>S(i.id)},[e("div",et,[e("img",{src:f(i.cover_image_url||"/placeholder-property.svg"),alt:i.title,class:"property-image"},null,8,tt),e("div",ot,l(V(i.price)),1)]),e("div",st,[e("h3",at,l(i.title),1),e("p",nt,l(i.address)+", "+l(i.city),1),e("div",lt,[i.bedrooms?(s(),a("span",it,[t[18]||(t[18]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M2 4v16"}),e("path",{d:"M2 8h18a2 2 0 0 1 2 2v10"}),e("path",{d:"M2 17h20"}),e("path",{d:"M6 8v9"})],-1)),p(" "+l(i.bedrooms),1)])):r("",!0),i.bathrooms?(s(),a("span",rt,[t[19]||(t[19]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 6 6.5 3.5a1.5 1.5 0 0 0-1-.5C4.683 3 4 3.683 4 4.5V17a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5"}),e("line",{x1:"10",x2:"8",y1:"5",y2:"7"}),e("line",{x1:"2",x2:"22",y1:"12",y2:"12"}),e("line",{x1:"7",x2:"7",y1:"19",y2:"21"}),e("line",{x1:"17",x2:"17",y1:"19",y2:"21"})],-1)),p(" "+l(i.bathrooms),1)])):r("",!0),i.area?(s(),a("span",ct,[t[20]||(t[20]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),e("circle",{cx:"12",cy:"10",r:"3"})],-1)),p(" "+l(i.area)+"m² ",1)])):r("",!0),i.status?(s(),a("span",dt,[t[21]||(t[21]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"m9 12 2 2 4-4"})],-1)),p(" "+l(i.status),1)])):r("",!0)])])],8,Ye))),128))])])])):r("",!0)])):(s(),a("div",ut,[e("div",{class:"not-found-content"},[t[22]||(t[22]=e("svg",{class:"not-found-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})],-1)),t[23]||(t[23]=e("p",{class:"not-found-message"},"Proyecto no encontrado",-1)),e("button",{onClick:j,class:"back-btn-alt"},"Volver a Proyectos")])]))]}),_:1}))}}),yt=K(vt,[["__scopeId","data-v-66e3bf14"]]);export{yt as default};
