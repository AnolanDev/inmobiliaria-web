import{d as E,c as n,o,b as Y,s as Z,r as B,i as P,w as ee,k as se,G as te,g as S,l as ae,a as s,f as v,q as l,t as c,B as F,C as oe,E as I,F as b,p as k,n as q,e as V,j as z}from"./index-CWEr14dP.js";import{u as le,B as R}from"./BlogCard-yo06hx_B.js";import{_ as G,A as ne}from"./AppLayout-DQsgIWhf.js";import"./api-Cpf0xzVV.js";import"./ResponsiveImage-Ci10gqQx.js";const ie={class:"bg-white rounded-xl border border-gray-200 overflow-hidden animate-pulse"},re=E({__name:"BlogCardSkeleton",setup(H){return(p,d)=>(o(),n("div",ie,d[0]||(d[0]=[Y('<div class="h-48 sm:h-52 md:h-56 bg-gray-200" data-v-181e103e></div><div class="p-4 space-y-3" data-v-181e103e><div class="space-y-2" data-v-181e103e><div class="h-4 bg-gray-200 rounded w-3/4" data-v-181e103e></div><div class="h-4 bg-gray-200 rounded w-1/2" data-v-181e103e></div></div><div class="flex items-center space-x-3" data-v-181e103e><div class="w-4 h-4 bg-gray-200 rounded-full" data-v-181e103e></div><div class="h-3 bg-gray-200 rounded w-20" data-v-181e103e></div><div class="h-3 bg-gray-200 rounded w-16" data-v-181e103e></div></div><div class="space-y-2" data-v-181e103e><div class="h-3 bg-gray-200 rounded w-full" data-v-181e103e></div><div class="h-3 bg-gray-200 rounded w-4/5" data-v-181e103e></div></div><div class="flex space-x-2" data-v-181e103e><div class="h-6 bg-gray-200 rounded-full w-12" data-v-181e103e></div><div class="h-6 bg-gray-200 rounded-full w-16" data-v-181e103e></div><div class="h-6 bg-gray-200 rounded-full w-10" data-v-181e103e></div></div><div class="flex justify-between items-center pt-2" data-v-181e103e><div class="flex space-x-4" data-v-181e103e><div class="h-3 bg-gray-200 rounded w-12" data-v-181e103e></div><div class="h-3 bg-gray-200 rounded w-8" data-v-181e103e></div></div><div class="h-3 bg-gray-200 rounded w-16" data-v-181e103e></div></div><div class="pt-3 border-t border-gray-200" data-v-181e103e><div class="h-9 bg-gray-200 rounded w-full" data-v-181e103e></div></div></div>',2)])))}}),U=G(re,[["__scopeId","data-v-181e103e"]]),de={key:0,class:"loading-container"},ue={key:1,class:"error-container"},ce={class:"error-content"},ve={class:"error-message"},ge={key:2,class:"main-content"},pe={class:"container"},he={class:"filters-section"},fe={class:"filter-row"},ye={class:"search-container"},me={class:"search-input-wrapper"},be={class:"filter-container"},ke=["value"],_e={class:"filter-container"},we={key:0,class:"active-filters"},Ce={class:"filter-tags"},xe={key:0,class:"filter-tag"},Be={key:1,class:"filter-tag"},Pe={key:0,class:"featured-section"},Me={class:"featured-grid"},Te={class:"results-info"},Le={class:"results-text"},Se={key:0},Fe={key:1},Ve={class:"blogs-section"},$e={key:0,class:"no-results"},je={key:1,class:"blogs-grid"},Ae={key:1,class:"load-more-container"},De=["disabled"],Ne={key:0},Ie={key:1,class:"flex items-center"},qe={class:"load-more-info"},ze={key:2,class:"pagination"},Re=["disabled"],Ue={class:"pagination-numbers"},Ee=["onClick"],Ge=["disabled"],He={key:3,class:"loading-overlay"},Oe=E({__name:"BlogsPage",setup(H){const p=le(),{blogs:d,featuredBlogs:h,categories:O,isLoading:f,error:$,pagination:i}=Z(p),r=B(""),u=B(""),w=B("recent"),C=B([]);let M=null;const g=P(()=>r.value.length>0||u.value.length>0),y=P(()=>{let a=g.value?C.value:d.value;if(!g.value&&h.value.length>0){const e=new Set(h.value.map(t=>t.id));a=a.filter(t=>!e.has(t.id))}return w.value==="popular"?a=[...a].sort((e,t)=>(t.views_count||0)-(e.views_count||0)):w.value==="title"?a=[...a].sort((e,t)=>e.title.localeCompare(t.title)):a=[...a].sort((e,t)=>new Date(t.published_at).getTime()-new Date(e.published_at).getTime()),a}),Q=P(()=>{const a=y.value.length;return{"blogs-grid":!0,"single-blog":a===1,"two-blogs":a===2,"three-blogs":a===3,"multiple-blogs":a>3}}),W=P(()=>{const a=i.value.currentPage,e=i.value.lastPage,t=2,_=[],m=[];for(let L=Math.max(2,a-t);L<=Math.min(e-1,a+t);L++)_.push(L);return a-t>2?m.push(1,"..."):m.push(1),m.push(..._),a+t<e-1?m.push("...",e):e>1&&m.push(e),m}),j=async(a=1)=>{await p.fetchBlogs({with:"media,image,featured_image",include:"featured_image,gallery,media,image",fields:"*"},a)},A=()=>{M&&clearTimeout(M),M=setTimeout(()=>{x()},300)},x=()=>{if(!u.value&&!r.value){C.value=[];return}let a=[...d.value];if(u.value&&(a=a.filter(e=>e.category===u.value)),r.value){const e=r.value.toLowerCase().trim();a=a.filter(t=>t.title.toLowerCase().includes(e)||t.excerpt.toLowerCase().includes(e)||t.content.toLowerCase().includes(e)||t.tags.some(_=>_.toLowerCase().includes(e))||t.category.toLowerCase().includes(e))}C.value=a},J=()=>{},D=()=>{r.value="",A()},K=()=>{u.value="",x()},N=()=>{r.value="",u.value="",C.value=[]},X=async()=>{i.value.currentPage<i.value.lastPage&&await p.loadMoreBlogs(i.value.currentPage+1)},T=a=>{a>=1&&a<=i.value.lastPage&&(j(a),window.scrollTo({top:0,behavior:"smooth"}))};return ee([r,u],()=>{x()}),se(async()=>{try{await p.fetchBlogs({per_page:6,with:"media,image,featured_image",include:"featured_image,gallery,media,image",fields:"*"},1),p.fetchBlogCategories().catch(a=>console.warn("Failed to load categories:",a)),setTimeout(()=>{p.fetchFeaturedBlogs().catch(a=>console.warn("Failed to load featured blogs:",a))},1e3),await te()}catch(a){console.error("Failed to load blogs:",a)}}),(a,e)=>(o(),S(ne,null,{default:ae(()=>[e[22]||(e[22]=s("section",{class:"page-header"},[s("div",{class:"container"},[s("div",{class:"header-content"},[s("h1",{class:"page-title"},"Blog"),s("p",{class:"page-description"}," Descubre artículos, consejos y tendencias del sector inmobiliario ")])])],-1)),l(f)&&l(d).length===0?(o(),n("div",de,e[5]||(e[5]=[s("div",{class:"loading-content"},[s("div",{class:"loading-spinner"}),s("p",{class:"loading-text"},"Cargando blogs...")],-1)]))):l($)&&l(d).length===0?(o(),n("div",ue,[s("div",ce,[e[6]||(e[6]=s("svg",{class:"error-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 15.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),s("p",ve,c(l($)),1),s("button",{onClick:j,class:"retry-btn"},"Reintentar")])])):(o(),n("div",ge,[s("div",pe,[s("div",he,[s("div",fe,[s("div",ye,[s("div",me,[e[8]||(e[8]=s("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("circle",{cx:"11",cy:"11",r:"8"}),s("path",{d:"M21 21l-4.35-4.35"})],-1)),F(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),type:"text",placeholder:"Buscar blogs...",class:"search-input",onInput:A},null,544),[[oe,r.value]]),r.value?(o(),n("button",{key:0,onClick:D,class:"clear-search-btn"},e[7]||(e[7]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))):v("",!0)])]),s("div",be,[F(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t),onChange:x,class:"filter-select"},[e[9]||(e[9]=s("option",{value:""},"Todas las categorías",-1)),(o(!0),n(b,null,k(l(O),t=>(o(),n("option",{key:t,value:t},c(t),9,ke))),128))],544),[[I,u.value]])]),s("div",_e,[F(s("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>w.value=t),onChange:J,class:"filter-select"},e[10]||(e[10]=[s("option",{value:"recent"},"Más recientes",-1),s("option",{value:"popular"},"Más populares",-1),s("option",{value:"title"},"Por título",-1)]),544),[[I,w.value]])])]),g.value?(o(),n("div",we,[e[13]||(e[13]=s("span",{class:"active-filters-label"},"Filtros activos:",-1)),s("div",Ce,[r.value?(o(),n("span",xe,[s("span",null,'Búsqueda: "'+c(r.value)+'"',1),s("button",{onClick:D},e[11]||(e[11]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))])):v("",!0),u.value?(o(),n("span",Be,[s("span",null,"Categoría: "+c(u.value),1),s("button",{onClick:K},e[12]||(e[12]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))])):v("",!0)]),s("button",{onClick:N,class:"clear-filters-btn"}," Limpiar todos los filtros ")])):v("",!0)]),l(h).length>0&&!g.value?(o(),n("section",Pe,[e[14]||(e[14]=s("div",{class:"section-header"},[s("h2",{class:"section-title"},"Artículos destacados")],-1)),s("div",Me,[(o(!0),n(b,null,k(l(h).slice(0,3),t=>(o(),S(R,{key:`featured-${t.id}`,blog:t,class:"featured-card"},null,8,["blog"]))),128))])])):v("",!0),s("div",Te,[s("p",Le,[g.value?(o(),n("span",Se,c(y.value.length)+" "+c(y.value.length===1?"resultado encontrado":"resultados encontrados"),1)):(o(),n("span",Fe," Mostrando "+c(y.value.length)+" blogs"+c(l(h).length>0?` (+ ${l(h).length} destacados)`:""),1))])]),s("section",Ve,[y.value.length===0&&g.value?(o(),n("div",$e,[e[15]||(e[15]=s("svg",{class:"no-results-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e[16]||(e[16]=s("h3",null,"No se encontraron blogs",-1)),e[17]||(e[17]=s("p",null,"Intenta ajustar tus filtros de búsqueda",-1)),s("button",{onClick:N,class:"clear-filters-btn"}," Ver todos los blogs ")])):v("",!0),l(f)&&l(d).length===0?(o(),n("div",je,[(o(),n(b,null,k(6,t=>z(U,{key:`skeleton-${t}`})),64))])):(o(),n("div",{key:2,class:q(Q.value)},[(o(!0),n(b,null,k(y.value,t=>(o(),S(R,{key:t.id,blog:t},null,8,["blog"]))),128)),l(f)&&l(d).length>0?(o(),n(b,{key:0},k(3,t=>z(U,{key:`loading-${t}`})),64)):v("",!0)],2))]),l(i).currentPage<l(i).lastPage&&!g.value?(o(),n("div",Ae,[s("button",{onClick:X,disabled:l(f),class:"load-more-btn"},[l(f)?(o(),n("span",Ie,e[18]||(e[18]=[s("div",{class:"loading-spinner-small mr-2"},null,-1),V(" Cargando... ",-1)]))):(o(),n("span",Ne,"Cargar más artículos"))],8,De),s("p",qe," Mostrando "+c(l(d).length)+" de "+c(l(i).total)+" artículos ",1)])):v("",!0),l(i).lastPage>1&&g.value?(o(),n("div",ze,[s("button",{onClick:e[3]||(e[3]=t=>T(l(i).currentPage-1)),disabled:l(i).currentPage<=1,class:"pagination-btn"},e[19]||(e[19]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M15 18l-6-6 6-6"})],-1),V(" Anterior ",-1)]),8,Re),s("div",Ue,[(o(!0),n(b,null,k(W.value,t=>(o(),n("button",{key:t,onClick:_=>T(t),class:q(["pagination-number",{active:t===l(i).currentPage}])},c(t),11,Ee))),128))]),s("button",{onClick:e[4]||(e[4]=t=>T(l(i).currentPage+1)),disabled:l(i).currentPage>=l(i).lastPage,class:"pagination-btn"},e[20]||(e[20]=[V(" Siguiente ",-1),s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M9 18l6-6-6-6"})],-1)]),8,Ge)])):v("",!0)])])),l(f)&&l(d).length>0?(o(),n("div",He,e[21]||(e[21]=[s("div",{class:"loading-spinner"},null,-1)]))):v("",!0)]),_:1,__:[22]}))}}),Ye=G(Oe,[["__scopeId","data-v-8a0869cd"]]);export{Ye as default};
