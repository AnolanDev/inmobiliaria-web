import{d as U,c as n,o,b as K,s as X,r as B,i as S,w as Y,k as Z,l as T,m as ee,a as s,f as v,x as l,t as c,g as F,D as se,G as I,F as m,q as _,e as V,j as q,n as te}from"./index-pdNRFkLu.js";import{u as ae,B as z}from"./BlogCard-C3FeKqs_.js";import{_ as E,A as oe}from"./AppLayout-DRYt7Stj.js";import"./api-DRWUNwWI.js";const le={class:"bg-white rounded-xl border border-gray-200 overflow-hidden animate-pulse"},ne=U({__name:"BlogCardSkeleton",setup(G){return(p,d)=>(o(),n("div",le,d[0]||(d[0]=[K('<div class="h-48 sm:h-52 md:h-56 bg-gray-200" data-v-181e103e></div><div class="p-4 space-y-3" data-v-181e103e><div class="space-y-2" data-v-181e103e><div class="h-4 bg-gray-200 rounded w-3/4" data-v-181e103e></div><div class="h-4 bg-gray-200 rounded w-1/2" data-v-181e103e></div></div><div class="flex items-center space-x-3" data-v-181e103e><div class="w-4 h-4 bg-gray-200 rounded-full" data-v-181e103e></div><div class="h-3 bg-gray-200 rounded w-20" data-v-181e103e></div><div class="h-3 bg-gray-200 rounded w-16" data-v-181e103e></div></div><div class="space-y-2" data-v-181e103e><div class="h-3 bg-gray-200 rounded w-full" data-v-181e103e></div><div class="h-3 bg-gray-200 rounded w-4/5" data-v-181e103e></div></div><div class="flex space-x-2" data-v-181e103e><div class="h-6 bg-gray-200 rounded-full w-12" data-v-181e103e></div><div class="h-6 bg-gray-200 rounded-full w-16" data-v-181e103e></div><div class="h-6 bg-gray-200 rounded-full w-10" data-v-181e103e></div></div><div class="flex justify-between items-center pt-2" data-v-181e103e><div class="flex space-x-4" data-v-181e103e><div class="h-3 bg-gray-200 rounded w-12" data-v-181e103e></div><div class="h-3 bg-gray-200 rounded w-8" data-v-181e103e></div></div><div class="h-3 bg-gray-200 rounded w-16" data-v-181e103e></div></div><div class="pt-3 border-t border-gray-200" data-v-181e103e><div class="h-9 bg-gray-200 rounded w-full" data-v-181e103e></div></div></div>',2)])))}}),R=E(ne,[["__scopeId","data-v-181e103e"]]),ie={key:0,class:"loading-container"},re={key:1,class:"error-container"},de={class:"error-content"},ue={class:"error-message"},ce={key:2,class:"main-content"},ve={class:"container"},ge={class:"filters-section"},pe={class:"filter-row"},he={class:"search-container"},fe={class:"search-input-wrapper"},ye={class:"filter-container"},me=["value"],_e={class:"filter-container"},be={key:0,class:"active-filters"},ke={class:"filter-tags"},we={key:0,class:"filter-tag"},xe={key:1,class:"filter-tag"},Ce={key:0,class:"featured-section"},Be={class:"featured-grid"},Pe={class:"results-info"},Me={class:"results-text"},Le={key:0},Se={key:1},Te={class:"blogs-section"},Fe={key:0,class:"no-results"},Ve={key:1,class:"blogs-grid"},$e={key:2,class:"blogs-grid"},De={key:1,class:"load-more-container"},je=["disabled"],Ae={key:0},Ne={key:1,class:"flex items-center"},Ie={class:"load-more-info"},qe={key:2,class:"pagination"},ze=["disabled"],Re={class:"pagination-numbers"},Ue=["onClick"],Ee=["disabled"],Ge={key:3,class:"loading-overlay"},He=U({__name:"BlogsPage",setup(G){const p=ae(),{blogs:d,featuredBlogs:h,categories:H,isLoading:f,error:$,pagination:i}=X(p),r=B(""),u=B(""),w=B("recent"),x=B([]);let P=null;const g=S(()=>r.value.length>0||u.value.length>0),b=S(()=>{let a=g.value?x.value:d.value;if(!g.value&&h.value.length>0){const e=new Set(h.value.map(t=>t.id));a=a.filter(t=>!e.has(t.id))}return w.value==="popular"?a=[...a].sort((e,t)=>(t.views_count||0)-(e.views_count||0)):w.value==="title"?a=[...a].sort((e,t)=>e.title.localeCompare(t.title)):a=[...a].sort((e,t)=>new Date(t.published_at).getTime()-new Date(e.published_at).getTime()),a}),O=S(()=>{const a=i.value.currentPage,e=i.value.lastPage,t=2,k=[],y=[];for(let L=Math.max(2,a-t);L<=Math.min(e-1,a+t);L++)k.push(L);return a-t>2?y.push(1,"..."):y.push(1),y.push(...k),a+t<e-1?y.push("...",e):e>1&&y.push(e),y}),D=async(a=1)=>{await p.fetchBlogs({with:"media,image,featured_image",include:"featured_image,gallery,media,image",fields:"*"},a)},j=()=>{P&&clearTimeout(P),P=setTimeout(()=>{C()},300)},C=()=>{if(!u.value&&!r.value){x.value=[];return}let a=[...d.value];if(u.value&&(a=a.filter(e=>e.category===u.value)),r.value){const e=r.value.toLowerCase().trim();a=a.filter(t=>t.title.toLowerCase().includes(e)||t.excerpt.toLowerCase().includes(e)||t.content.toLowerCase().includes(e)||t.tags.some(k=>k.toLowerCase().includes(e))||t.category.toLowerCase().includes(e))}x.value=a},Q=()=>{},A=()=>{r.value="",j()},W=()=>{u.value="",C()},N=()=>{r.value="",u.value="",x.value=[]},J=async()=>{i.value.currentPage<i.value.lastPage&&await p.loadMoreBlogs(i.value.currentPage+1)},M=a=>{a>=1&&a<=i.value.lastPage&&(D(a),window.scrollTo({top:0,behavior:"smooth"}))};return Y([r,u],()=>{C()}),Z(async()=>{try{await p.fetchBlogs({per_page:6,with:"media,image,featured_image",include:"featured_image,gallery,media,image",fields:"*"},1),p.fetchBlogCategories().catch(a=>console.warn("Failed to load categories:",a)),setTimeout(()=>{p.fetchFeaturedBlogs().catch(a=>console.warn("Failed to load featured blogs:",a))},1e3)}catch(a){console.error("Failed to load blogs:",a)}}),(a,e)=>(o(),T(oe,null,{default:ee(()=>[e[22]||(e[22]=s("section",{class:"page-header"},[s("div",{class:"container"},[s("div",{class:"header-content"},[s("h1",{class:"page-title"},"Blog"),s("p",{class:"page-description"}," Descubre artículos, consejos y tendencias del sector inmobiliario ")])])],-1)),l(f)&&l(d).length===0?(o(),n("div",ie,e[5]||(e[5]=[s("div",{class:"loading-content"},[s("div",{class:"loading-spinner"}),s("p",{class:"loading-text"},"Cargando blogs...")],-1)]))):l($)&&l(d).length===0?(o(),n("div",re,[s("div",de,[e[6]||(e[6]=s("svg",{class:"error-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 15.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),s("p",ue,c(l($)),1),s("button",{onClick:D,class:"retry-btn"},"Reintentar")])])):(o(),n("div",ce,[s("div",ve,[s("div",ge,[s("div",pe,[s("div",he,[s("div",fe,[e[8]||(e[8]=s("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("circle",{cx:"11",cy:"11",r:"8"}),s("path",{d:"M21 21l-4.35-4.35"})],-1)),F(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),type:"text",placeholder:"Buscar blogs...",class:"search-input",onInput:j},null,544),[[se,r.value]]),r.value?(o(),n("button",{key:0,onClick:A,class:"clear-search-btn"},e[7]||(e[7]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))):v("",!0)])]),s("div",ye,[F(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t),onChange:C,class:"filter-select"},[e[9]||(e[9]=s("option",{value:""},"Todas las categorías",-1)),(o(!0),n(m,null,_(l(H),t=>(o(),n("option",{key:t,value:t},c(t),9,me))),128))],544),[[I,u.value]])]),s("div",_e,[F(s("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>w.value=t),onChange:Q,class:"filter-select"},e[10]||(e[10]=[s("option",{value:"recent"},"Más recientes",-1),s("option",{value:"popular"},"Más populares",-1),s("option",{value:"title"},"Por título",-1)]),544),[[I,w.value]])])]),g.value?(o(),n("div",be,[e[13]||(e[13]=s("span",{class:"active-filters-label"},"Filtros activos:",-1)),s("div",ke,[r.value?(o(),n("span",we,[s("span",null,'Búsqueda: "'+c(r.value)+'"',1),s("button",{onClick:A},e[11]||(e[11]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))])):v("",!0),u.value?(o(),n("span",xe,[s("span",null,"Categoría: "+c(u.value),1),s("button",{onClick:W},e[12]||(e[12]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))])):v("",!0)]),s("button",{onClick:N,class:"clear-filters-btn"}," Limpiar todos los filtros ")])):v("",!0)]),l(h).length>0&&!g.value?(o(),n("section",Ce,[e[14]||(e[14]=s("div",{class:"section-header"},[s("h2",{class:"section-title"},"Artículos destacados")],-1)),s("div",Be,[(o(!0),n(m,null,_(l(h).slice(0,3),t=>(o(),T(z,{key:`featured-${t.id}`,blog:t,class:"featured-card"},null,8,["blog"]))),128))])])):v("",!0),s("div",Pe,[s("p",Me,[g.value?(o(),n("span",Le,c(b.value.length)+" "+c(b.value.length===1?"resultado encontrado":"resultados encontrados"),1)):(o(),n("span",Se," Mostrando "+c(b.value.length)+" blogs"+c(l(h).length>0?` (+ ${l(h).length} destacados)`:""),1))])]),s("section",Te,[b.value.length===0&&g.value?(o(),n("div",Fe,[e[15]||(e[15]=s("svg",{class:"no-results-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e[16]||(e[16]=s("h3",null,"No se encontraron blogs",-1)),e[17]||(e[17]=s("p",null,"Intenta ajustar tus filtros de búsqueda",-1)),s("button",{onClick:N,class:"clear-filters-btn"}," Ver todos los blogs ")])):v("",!0),l(f)&&l(d).length===0?(o(),n("div",Ve,[(o(),n(m,null,_(6,t=>q(R,{key:`skeleton-${t}`})),64))])):(o(),n("div",$e,[(o(!0),n(m,null,_(b.value,t=>(o(),T(z,{key:t.id,blog:t},null,8,["blog"]))),128)),l(f)&&l(d).length>0?(o(),n(m,{key:0},_(3,t=>q(R,{key:`loading-${t}`})),64)):v("",!0)]))]),l(i).currentPage<l(i).lastPage&&!g.value?(o(),n("div",De,[s("button",{onClick:J,disabled:l(f),class:"load-more-btn"},[l(f)?(o(),n("span",Ne,e[18]||(e[18]=[s("div",{class:"loading-spinner-small mr-2"},null,-1),V(" Cargando... ",-1)]))):(o(),n("span",Ae,"Cargar más artículos"))],8,je),s("p",Ie," Mostrando "+c(l(d).length)+" de "+c(l(i).total)+" artículos ",1)])):v("",!0),l(i).lastPage>1&&g.value?(o(),n("div",qe,[s("button",{onClick:e[3]||(e[3]=t=>M(l(i).currentPage-1)),disabled:l(i).currentPage<=1,class:"pagination-btn"},e[19]||(e[19]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M15 18l-6-6 6-6"})],-1),V(" Anterior ",-1)]),8,ze),s("div",Re,[(o(!0),n(m,null,_(O.value,t=>(o(),n("button",{key:t,onClick:k=>M(t),class:te(["pagination-number",{active:t===l(i).currentPage}])},c(t),11,Ue))),128))]),s("button",{onClick:e[4]||(e[4]=t=>M(l(i).currentPage+1)),disabled:l(i).currentPage>=l(i).lastPage,class:"pagination-btn"},e[20]||(e[20]=[V(" Siguiente ",-1),s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M9 18l6-6-6-6"})],-1)]),8,Ee)])):v("",!0)])])),l(f)&&l(d).length>0?(o(),n("div",Ge,e[21]||(e[21]=[s("div",{class:"loading-spinner"},null,-1)]))):v("",!0)]),_:1,__:[22]}))}}),Ke=E(He,[["__scopeId","data-v-ee6751e9"]]);export{Ke as default};
