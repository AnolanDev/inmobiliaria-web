import{d as K,s as W,r as _,j as z,f as J,G as Q,h as D,l as X,v as Y,c as r,g as i,q as a,a as e,t as n,e as Z,F as b,p as C,A as ee,u as te,o as l}from"./index-DufdCJdL.js";import{u as oe,B as se}from"./BlogCard-CLvFVlka.js";import{A as ae,_ as le}from"./AppLayout-BF_5kZt5.js";import"./api-uPx9hDD2.js";import"./ResponsiveImage-CxpuF5x7.js";const re={key:0,class:"loading-container"},ne={key:1,class:"error-container"},ie={class:"error-content"},ce={class:"error-message"},de={key:0,class:"error-details"},ue={key:2,class:"blog-detail"},ge={class:"blog-header"},ve={class:"blog-meta"},pe={class:"meta-row"},he={class:"author-info"},me=["src","alt"],_e={key:1,class:"author-avatar-default"},fe={class:"author-details"},ke={class:"author-name"},ye={class:"publish-date"},we={class:"blog-stats"},be={key:0,class:"stat-item"},Ce={key:1,class:"stat-item"},xe={class:"badges-row"},Be={class:"category-badge"},Me={key:0,class:"featured-badge"},Ie={class:"blog-title"},Le={key:0,class:"blog-excerpt"},Ae={key:1,class:"blog-tags"},$e=["onClick"],Ee={key:0,class:"featured-image-container"},ze=["src","alt"],De={class:"blog-content-wrapper"},Re=["innerHTML"],Te={key:1,class:"blog-gallery"},Se={class:"gallery-grid"},Ue=["onClick"],Ve=["src","alt"],He={class:"share-section"},Oe={class:"share-buttons"},Fe={key:2,class:"related-blogs"},Ne={class:"related-blogs-grid"},Pe=["src","alt"],je={key:0,class:"modal-navigation"},qe={class:"modal-counter"},Ge=K({__name:"BlogDetailPage",setup(Ke){const R=Y(),x=te(),B=oe(),{currentBlog:o,isLoading:T,error:f,publishedBlogs:S}=W(B),v=_(!1),p=_(""),u=_(0),k=_(!1),M=z(()=>o.value?S.value.filter(s=>{var t,c;return s.id!==((t=o.value)==null?void 0:t.id)&&(s.category===((c=o.value)==null?void 0:c.category)||s.tags.some(h=>{var g;return(g=o.value)==null?void 0:g.tags.includes(h)}))}).slice(0,3):[]),y=z(()=>s=>s?s.includes("app.tierrasonada.com")?s.replace("https://app.tierrasonada.com","").replace("http://app.tierrasonada.com",""):s:"https://via.placeholder.com/800x400/f3f4f6/6b7280?text=Blog+Image"),I=async()=>{const s=R.params.id;try{await B.fetchBlog(s)}catch(t){console.error("Error fetching blog:",t)}},U=s=>new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),V=s=>s>=1e6?Math.floor(s/1e6)+"M":s>=1e3?Math.floor(s/1e3)+"K":s.toString(),H=s=>s.replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br>").replace(/^/,"<p>").replace(/$/,"</p>"),O=(s,t)=>{p.value=s,u.value=t,v.value=!0,document.body.style.overflow="hidden"},w=()=>{v.value=!1,document.body.style.overflow=""},L=()=>{var s;if((s=o.value)!=null&&s.gallery_urls){const t=u.value>0?u.value-1:o.value.gallery_urls.length-1;u.value=t,p.value=o.value.gallery_urls[t]}},A=()=>{var s;if((s=o.value)!=null&&s.gallery_urls){const t=u.value<o.value.gallery_urls.length-1?u.value+1:0;u.value=t,p.value=o.value.gallery_urls[t]}},F=()=>{const s=window.location.href;window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(s)}`,"_blank")},N=()=>{var c;const s=window.location.href,t=((c=o.value)==null?void 0:c.title)||"Mira este artículo";window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(s)}&text=${encodeURIComponent(t)}`,"_blank")},P=()=>{var c;const s=window.location.href,t=`${((c=o.value)==null?void 0:c.title)||"Mira este artículo"} ${s}`;window.open(`https://wa.me/?text=${encodeURIComponent(t)}`,"_blank")},j=async()=>{try{await navigator.clipboard.writeText(window.location.href),k.value=!0,setTimeout(()=>{k.value=!1},2e3)}catch(s){console.error("Error copying to clipboard:",s)}},q=s=>{x.push({path:"/blog",query:{tag:s}})},G=s=>{const t=s.target;console.log("BlogDetailPage: Image failed to load:",t.src),t.src="https://via.placeholder.com/800x400/f3f4f6/6b7280?text=Sin+Imagen"},$=()=>{x.push("/blog")},E=s=>{v.value&&(s.key==="Escape"?w():s.key==="ArrowLeft"?L():s.key==="ArrowRight"&&A())};return J(async()=>{await I(),document.addEventListener("keydown",E)}),Q(()=>{document.removeEventListener("keydown",E),document.body.style.overflow=""}),(s,t)=>(l(),D(ae,null,{default:X(()=>{var c,h,g;return[a(T)?(l(),r("div",re,t[1]||(t[1]=[e("div",{class:"loading-content"},[e("div",{class:"loading-spinner"}),e("p",{class:"loading-text"},"Cargando artículo...")],-1)]))):a(f)&&!a(o)?(l(),r("div",ne,[e("div",ie,[t[2]||(t[2]=e("svg",{class:"error-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 15.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),e("p",ce,n(a(f)),1),(c=a(f))!=null&&c.includes("servidor")?(l(),r("p",de," El artículo puede no estar disponible temporalmente. Por favor, inténtalo más tarde o contacta con el administrador. ")):i("",!0),e("div",{class:"error-actions"},[e("button",{onClick:I,class:"retry-btn"},"Reintentar"),e("button",{onClick:$,class:"back-btn-error"},"Volver al Blog")])])])):a(o)&&a(o).id?(l(),r("article",ue,[e("div",{class:"back-navigation"},[e("button",{onClick:$,class:"back-btn"},t[3]||(t[3]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),e("span",null,"Volver al Blog",-1)]))]),e("header",ge,[e("div",ve,[e("div",pe,[e("div",he,[a(o).author_avatar?(l(),r("img",{key:0,src:a(o).author_avatar,alt:a(o).author_name,class:"author-avatar"},null,8,me)):(l(),r("div",_e,t[4]||(t[4]=[e("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})],-1)]))),e("div",fe,[e("span",ke,n(a(o).author_name),1),e("span",ye,n(U(a(o).published_at)),1)])]),e("div",we,[a(o).reading_time?(l(),r("div",be,[t[5]||(t[5]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("polyline",{points:"12,6 12,12 16,14"})],-1)),e("span",null,n(a(o).reading_time)+" min de lectura",1)])):i("",!0),a(o).views_count?(l(),r("div",Ce,[t[6]||(t[6]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e("circle",{cx:"12",cy:"12",r:"3"})],-1)),e("span",null,n(V(a(o).views_count))+" "+n(a(o).views_count===1?"vista":"vistas"),1)])):i("",!0)])]),e("div",xe,[e("span",Be,n(a(o).category),1),a(o).is_featured?(l(),r("span",Me,t[7]||(t[7]=[e("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})],-1),Z(" Destacado ",-1)]))):i("",!0)])]),e("h1",Ie,n(a(o).title),1),a(o).excerpt?(l(),r("p",Le,n(a(o).excerpt),1)):i("",!0),a(o).tags&&a(o).tags.length>0?(l(),r("div",Ae,[(l(!0),r(b,null,C(a(o).tags,d=>(l(),r("span",{key:d,class:"tag",onClick:m=>q(d)}," #"+n(d),9,$e))),128))])):i("",!0)]),a(o).featured_image_url||a(o).featured_image?(l(),r("div",Ee,[e("img",{src:y.value(a(o).featured_image_url||a(o).featured_image),alt:a(o).title,class:"featured-image",onError:G},null,40,ze)])):i("",!0),e("div",De,[e("div",{class:"blog-content",innerHTML:H(a(o).content)},null,8,Re)]),a(o).gallery_urls&&a(o).gallery_urls.length>0?(l(),r("div",Te,[t[9]||(t[9]=e("h3",{class:"gallery-title"},"Galería",-1)),e("div",Se,[(l(!0),r(b,null,C(a(o).gallery_urls,(d,m)=>(l(),r("div",{key:m,class:"gallery-item",onClick:We=>O(d,m)},[e("img",{src:y.value(d),alt:`${a(o).title} - Imagen ${m+1}`,class:"gallery-image",loading:"lazy"},null,8,Ve),t[8]||(t[8]=e("div",{class:"gallery-overlay"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e("circle",{cx:"12",cy:"12",r:"3"})])],-1))],8,Ue))),128))])])):i("",!0),e("div",He,[t[14]||(t[14]=e("h3",{class:"share-title"},"Compartir este artículo",-1)),e("div",Oe,[e("button",{onClick:F,class:"share-btn facebook"},t[10]||(t[10]=[e("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})],-1),e("span",null,"Facebook",-1)])),e("button",{onClick:N,class:"share-btn twitter"},t[11]||(t[11]=[e("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"})],-1),e("span",null,"Twitter",-1)])),e("button",{onClick:P,class:"share-btn whatsapp"},t[12]||(t[12]=[e("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})],-1),e("span",null,"WhatsApp",-1)])),e("button",{onClick:j,class:"share-btn copy"},[t[13]||(t[13]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),e("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1)),e("span",null,n(k.value?"Copiado!":"Copiar enlace"),1)])])]),M.value.length>0?(l(),r("section",Fe,[t[15]||(t[15]=e("h3",{class:"section-title"},"Artículos relacionados",-1)),e("div",Ne,[(l(!0),r(b,null,C(M.value,d=>(l(),D(se,{key:d.id,blog:d,class:"related-blog-card"},null,8,["blog"]))),128))])])):i("",!0)])):i("",!0),v.value?(l(),r("div",{key:3,class:"image-modal",onClick:w},[e("div",{class:"image-modal-container",onClick:t[0]||(t[0]=ee(()=>{},["stop"]))},[e("button",{onClick:w,class:"modal-close-btn"},t[16]||(t[16]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])),e("img",{src:y.value(p.value),alt:(h=a(o))==null?void 0:h.title,class:"modal-image"},null,8,Pe),(g=a(o))!=null&&g.gallery_urls&&a(o).gallery_urls.length>1?(l(),r("div",je,[e("button",{onClick:L,class:"modal-nav-btn"},t[17]||(t[17]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)])),e("span",qe,n(u.value+1)+" / "+n(a(o).gallery_urls.length),1),e("button",{onClick:A,class:"modal-nav-btn"},t[18]||(t[18]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 18l6-6-6-6"})],-1)]))])):i("",!0)])])):i("",!0)]}),_:1}))}}),et=le(Ge,[["__scopeId","data-v-20d6ad2f"]]);export{et as default};
